<html>
<head>
<script src="scripts/jquery-3.2.1.min.js"></script>
<script src="parser.js"></script>

<script type='text/javascript'>
logrequest.onload = function (x) {
  onload()
  set_table(report, 'Meteor Shower')
  set_table(report, 'Lightning Hammer Storm')
  set_table(report, 'Lightning Storm')
  set_table(report, 'Firestorm')
  set_table(report, 'Fiery Rush')
  set_table(report, 'Lava Font')
  set_table(report, 'Pyroclastic Blast')
  set_table(report, 'Plasma Blast')
  set_table(report, 'Attunement')
  $('body').append($('<h3>All Hits</h3>'))
  set_table(report)
}
load_log()

function set_table(events, pattern) {
  if (pattern) {
    events = relativize_time(filter_by_pattern(events, pattern))
    $('body').append('<h3>'+events.length+' '+pattern+'</h3>')
  }
  const props = ['time', 'skill', 'agent', 'target']
  const table = $('<table>')
  const thead = $('<thead>')
  thead.append($(
    '<tr><th>Time</th><th>Skill</th><th>Agent</th><th>Target</th>'))
  table.append(thead)
  const tbody = $('<tbody>')
  for (var i in events) {
    var tr = $('<tr>')
    for (var j in props)
      $('<td class="c' + j + '">').html(events[i][props[j]]).appendTo(tr)
    tbody.append(tr)
  }
  table.append(tbody)
  $('body').append(table)
}

</script>
</head>
<body>
<style type="text/css">
th{text-align:left}
th,td{padding:0 1ex 0 1ex}
td.c0,td.c3{text-align:right}
</style>
</body>
</html>
